"use strict";(self.webpackChunkdjinn=self.webpackChunkdjinn||[]).push([[4039],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return f}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(r),f=a,h=d["".concat(c,".").concat(f)]||d[f]||p[f]||i;return r?n.createElement(h,o(o({ref:t},u),{},{components:r})):n.createElement(h,o({ref:t},u))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=r[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},115:function(e,t,r){r.r(t),r.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return f},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p}});var n=r(7462),a=r(3366),i=(r(7294),r(3905)),o=["components"],s={id:"persistance-layer",title:"Persistance Layer",sidebar_position:3,custom_edit_url:null},c="Persistance Layer",l={unversionedId:"architecture/djinn-board/architecture/persistance-layer",id:"architecture/djinn-board/architecture/persistance-layer",title:"Persistance Layer",description:"This is the layer that is used to keep a persistant state of the system, is accesed by the Authentication Service, the Gateway and the platform.",source:"@site/docs/architecture/djinn-board/architecture/persistance-layer.md",sourceDirName:"architecture/djinn-board/architecture",slug:"/architecture/djinn-board/architecture/persistance-layer",permalink:"/docs/architecture/djinn-board/architecture/persistance-layer",editUrl:null,tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"persistance-layer",title:"Persistance Layer",sidebar_position:3,custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"Platform",permalink:"/docs/architecture/djinn-board/architecture/platform"},next:{title:"Event Bus",permalink:"/docs/architecture/djinn-board/architecture/event-bus"}},u={},p=[{value:"Database",id:"database",level:2},{value:"Volumes",id:"volumes",level:2}],d={toc:p};function f(e){var t=e.components,s=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"persistance-layer"},"Persistance Layer"),(0,i.kt)("p",null,"This is the layer that is used to keep a persistant state of the system, is accesed by the Authentication Service, the Gateway and the platform."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Persistance Layer Diagram",src:r(5317).Z,width:"544",height:"445"})),(0,i.kt)("h2",{id:"database"},"Database"),(0,i.kt)("p",null,"The database is going to be a ",(0,i.kt)("a",{parentName:"p",href:"https://www.sqlite.org"},"sqlite")," database, since K3s is handling the resource managment, we are going to mount the ",(0,i.kt)("inlineCode",{parentName:"p"},"sqlite")," file into a volume with ",(0,i.kt)("inlineCode",{parentName:"p"},"k3s")," that way we have access to the database outside of K3s as well."),(0,i.kt)("p",null,"The database is going to store the devices that are link in the system, this will work as reference to list all the items of the network and their states and controls."),(0,i.kt)("h2",{id:"volumes"},"Volumes"),(0,i.kt)("p",null,"To keep persistance of the configuration files outside of the container lifecycle we are going to use ",(0,i.kt)("a",{parentName:"p",href:"https://rancher.com/docs/k3s/latest/en/storage/#pvc-yaml"},"volumes"),", which are going to be created and managed by ",(0,i.kt)("inlineCode",{parentName:"p"},"k3s"),"."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Keeping a copy of the files in the host operating system makes it easier to backup, migrate and restore.")),(0,i.kt)("p",null,"In the volumes we are going to store:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Plugin configuration files"),(0,i.kt)("li",{parentName:"ul"},"Plugin assets"),(0,i.kt)("li",{parentName:"ul"},"Board configuration files"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".sqlite")," database file")))}f.isMDXComponent=!0},5317:function(e,t,r){t.Z=r.p+"assets/images/persistance_layer-cc99f84b312bcca382c5a204f6b43e84.png"}}]);